<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Makerverse</title>
    <link href="style.css" rel="stylesheet" type="text/css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;600&display=swap" rel="stylesheet">

    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>

<body>
    <div id="app">
		<nav class="top-navbar">
			<div @click="home()" style="cursor: pointer;">
				<img class="logo" src="gear.svg" alt="Gear" @click="home()">
				<h1 @click="home()">Makerverse</h1>
			</div>

			<div class="search" v-if="page === 'home'">
				<input type="text" v-model="search" placeholder="Search..."></input>
				<img src="search.svg" alt="Search Icon" height="20" width="20">
			</div>

			<div class="links">
				<a href="#" @click="toSignIn()">Sign in</a>
				<a class="sign-up" href="#" @click="toSignUp()">Sign Up</a>
				<div v-if="request === 'show'" class="sign-in-request">Please Sign In</div>
			</div>
		</nav>

		<div class="search-mobile" v-if="page === 'home'">
			<input type="text" v-model="search" placeholder="Search..."></input>
			<img src="search.svg" alt="Search Icon" height="20" width="20">
		</div>
		

	<div class="view-make-page" v-if="page === 'viewMake'">
		<div class="view-make-listing">
			<div class="make-title">{{selectedMake.title}}</div>
			<div class="make-creator">Creator: {{selectedMake.user.username}}</div>
			<div class="make-img-container"><img :src="selectedMake.photos[0]"></div>

		    <div class="flex-parent">
				<div class="flex-child">
					<div v-if="!selectedMake.likes.includes(current_user.username)" class="make-likes" @click="likeMake(selectedMake)"><img src="heart.svg" alt="Like" height="40" width="40"></div>
					<div v-else class="make-likes" @click="likeMake(selectedMake)"><img src="heart-filled.svg" alt="Like" height="40" width="40"></div>
					<div class="like-count">{{selectedMake.likes.length}}</div>
				</div>

				<div class="flex-child">
					<div class="download-btn"><a :href="selectedMake.files[0]" :download="selectedMake.files[0].substr(49)">
						<img class="download-icon" src="download.svg" alt="Download">
						<span>Download</span></a>
					</div>
				</div>
	       	</div>
		</div>
	</div>

       <div class="makes" v-else>

	       <!-- Display searched makes if they are there -->
	       <div v-for="make in filteredMakes" class="make-listing" v-if="search.length > 0 && filteredMakes.length > 0">

		       <div class="make-title" @click="viewMake()">{{make.title}}</div>
		       <div class="make-creator" @click="viewMake()">Creator: {{make.user.username}}</div>
		       <div class="a"><img :src="make.photos[0]" alt="Make Object" @click="viewMake()"></div>

		       <div class="flex-parent">
			       <div class="flex-child">
					<div v-if="!make.likes.includes(current_user.username)" class="make-likes" @click="likeMake()"><img src="heart.svg" alt="Like" height="40" width="40"></div>
					<div v-else class="make-likes" @click="likeMake()"><img src="heart-filled.svg" alt="Like" height="40" width="40"></div>
				       <div class="like-count">{{make.likes.length}}</div>
			       </div>

			       <div class="flex-child">
						<div class="download-btn"><a :href="make.files[0]" :download="make.files[0].substr(49)">
							<img class="download-icon" src="download.svg" alt="Download">
							<span>Download</span>
						</a></div>
			    	</div>
	       		</div>


       </div>
	       <!-- Else, display all makes -->
	       <div v-for="make in makes" class="make-listing" v-if="page === 'home'">

		       <div class="make-title" @click="viewMake(make)">{{make.title}}</div>
		       <div class="make-creator" @click="viewMake(make)">Creator: {{make.user.username}}</div>
		       <div class="a"><img :src="make.photos[0]" alt="Make Object" @click="viewMake(make)"></div>

		       <div class="flex-parent">
			       <div class="flex-child">
					<div v-if="!make.likes.includes(current_user.username)" class="make-likes" @click="likeMake(make)"><img src="heart.svg" alt="Like" height="40" width="40"></div>
					<div v-else class="make-likes" @click="likeMake(make)"><img src="heart-filled.svg" alt="Like" height="40" width="40"></div>
				       <div class="like-count">{{make.likes.length}}</div>
			       </div>

			       <div class="flex-child">
				       <div class="download-btn"><a :href="make.files[0]" :download="make.files[0].substr(49)">
					       <img class="download-icon" src="download.svg" alt="Download">
					       <span>Download</span>
					   </a></div>
			       </div>
	       		</div>
       		</div>
    </div>

	<div v-show="authModal" class="auth-modal">
		<div class="auth-image-cont">
			<img src="gear.svg">
		</div>
		<div v-if="authType == 'in'" class="auth-parent">
			<h1>Welcome Back to Makerverse</h1>
			<div class="make-title">Sign In</div>
			<input type="email" placeholder="E-Mail" v-model="user_auth.email">
			<input type="text" placeholder="Password" v-model="user_auth.password">
			<div>
				<p>Not a Member? <a class="switch-auth" @click="toSignUp">Sign Up</a></p>
			</div>
			<button class="auth-btn" @click="createSession()">Sign In</button>
		</div>
		<div v-if="authType == 'up'" class="auth-parent">
			<h1>Welcome to Makerverse</h1>
			<input type="text" placeholder="Username" v-model="user_auth.username">
			<input type="email" placeholder="E-Mail" v-model="user_auth.email">
			<input type="text" placeholder="Password" v-model="user_auth.password">
			<div>
				<p>Already a Member? <a class="switch-auth" @click="toSignIn()">Sign In</a></p>
			</div>
			<button class="auth-btn" @click="signup()">Sign Up</button>
		</div>
		<div>
			<button class="home-btn" @click="home()">Home</button>
		</div>
	</div>

	<div v-if="page === 'create'" class="view-make-page">
		<div class="view-make-listing">
			<input type="text" placeholder="Make Name">
			<input type="text" placeholder="Description">
		</div>

		<div class="view-make-listing">
			<!-- Will need to figure out how to submit form with page... -->
			<form enctype="multipart/form-data" id="data" @submit.prevent="uploadImage()">
				<input type="file" name="images" accept="image/jpeg, image.png">
			</form>
		</div>

		<div class="view-make-listing">
			<input type="text" placeholder="Required Components">
		</div>

		<!-- Maybe a section for adding personal printer setup -->
	</div>





    </div>
    <script src="app.js"></script>
</body>

</html>
